# 💹 IA-FINANCIERA · ETL → Machine Learning → KPIs & Visuals

[![Python](https://img.shields.io/badge/Python-3.10%2B-3776AB)](https://www.python.org/)
[![pandas](https://img.shields.io/badge/pandas-2.x-150458)](https://pandas.pydata.org/)
[![scikit-learn](https://img.shields.io/badge/scikit--learn-1.x-f7931e)](https://scikit-learn.org/)
[![streamlit](https://img.shields.io/badge/Streamlit-Dashboard-E64A19)](https://streamlit.io/)

End-to-end project that extracts and transforms market data, engineers technical indicators, trains classification models, and produces **UP/DOWN** signals with KPIs and visuals.

> Data source: **Yahoo Finance** via `yfinance`. Visuals are generated from the transformed dataset.

## 🧭 Table of Contents
- [Goal](#goal)
- [Preview](#preview)
- [Features](#features)
- [Architecture](#architecture)
- [Star Schema](#star-schema)
- [Repository Structure](#repository-structure)
- [Install & Run](#install--run)
- [Dashboard](#dashboard)
- [Backtest](#backtest)
- [License](#license)

## 🎯 Goal
- Build a clear **ETL → ML** pipeline for financial direction classification.
- Predict **PROBA_UP** with an ensemble (LogisticRegression + RandomForest).
- Report **Top-N bullish/bearish** and a compact probability summary.
- Produce visuals (**heatmap**) and an optional dashboard.

## 🖼️ Preview
<p align="center">
  <img src="images/heatmap_probs.png" alt="Probability Heatmap" width="70%" />
</p>
<p align="center">
  <em>Generated by <code>scripts/plot_heatmap.py</code> → <code>images/heatmap_probs.png</code></em>
</p>

## ✨ Features
- ETL: download, transform, deduplicate, and enrich OHLCV time series.
- Indicators: RSI, MACD, EMA/SMA, Bollinger Bands, ATR, etc.
- Classification: LogisticRegression + RandomForest + Ensemble (PROBA_UP).
- Outputs: Top-N (calls/puts), `models/prob_summary.csv`, heatmap PNG.
- Logging with automatic cleanup; light seed utilities.
- Optional Streamlit dashboard.

## 🏗️ Architecture

### Data Flow
```mermaid
flowchart LR
  A[yfinance tickers] --> B[extract.py]
  B --> C[transform.py]
  C --> D[load.py]
  D --> R[data/raw/*.csv]
  R --> E[train_all.py]
  R --> F[train_direction.py]
  F --> S[models/prob_summary.csv]
  F --> T[models/traces/*.csv]
  S --> H[images/heatmap_probs.png]
  S --> W[dashboard_app.py]
````

## 🧱 Star Schema

```mermaid
erDiagram
  SIGNALS {
    datetime datetime
    string   ticker
    float    proba_logreg
    float    proba_rf
    float    proba_ens
    string   pred
  }

  TICKER {
    string ticker
    string asset_class
  }

  DATE {
    datetime datetime
    int      year
    int      month
    int      day
  }

  MODEL {
    string name
    string type
    string notes
  }

  SIGNALS ||--o{ TICKER : has
  SIGNALS ||--o{ DATE   : occurs_on
  SIGNALS ||--o{ MODEL  : generated_by
```

## 📁 Repository Structure

```
ia-financiera/
├─ data/                 # raw & transformed market data
├─ models/               # training (regression/classification), traces, metrics
├─ etl/                  # extract/transform/load
├─ scripts/              # plotting utilities (heatmap)
├─ apps/                 # streamlit dashboard
├─ images/               # generated charts (heatmap_probs.png)
├─ reports/              # optional backtest outputs
├─ utils/                # config, logging, seed
├─ menu.py               # main entrypoint (ETL → Train → Predict)
├─ config.yaml           # configuration
└─ README.md             # this file
```

## ⚙️ Install & Run

```bash
git clone https://github.com/ShadowBlack33/ia-financiera.git
cd ia-financiera
python -m venv .venv
.venv\Scripts\activate         # Windows
# source .venv/bin/activate    # macOS/Linux
pip install -r requirements.txt
python menu.py
```

Generate the heatmap (preview):

```bash
python scripts/plot_heatmap.py   # → images/heatmap_probs.png
```

## 🖥️ Dashboard

```bash
streamlit run apps/dashboard_app.py
```

## 📈 Backtest

```bash
python -m models.backtest
```

## 📜 License

MIT © 2025 — ShadowBlack33
