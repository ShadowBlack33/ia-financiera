---

# `README.md`

````markdown
# 💹 IA-FINANCIERA · ETL → Machine Learning → KPIs & Visuals

[![Python](https://img.shields.io/badge/Python-3.10%2B-3776AB)](https://www.python.org/)
[![pandas](https://img.shields.io/badge/pandas-2.x-150458)](https://pandas.pydata.org/)
[![scikit-learn](https://img.shields.io/badge/scikit--learn-1.x-f7931e)](https://scikit-learn.org/)
[![streamlit](https://img.shields.io/badge/Streamlit-Dashboard-E64A19)](https://streamlit.io/)

End-to-end project that extracts and transforms market data, engineers technical indicators, trains classification models, and produces **UP/DOWN** signals with KPIs and visuals.

> Data source: **Yahoo Finance** via `yfinance`.  
> Visuals are generated from the transformed dataset — not from raw data.

---

## 🧭 Table of Contents
- [Goal](#goal)
- [Preview](#preview)
- [Features](#features)
- [Architecture](#architecture)
- [Star Schema](#star-schema)
- [Repository Structure](#repository-structure)
- [Install & Run](#install--run)
- [Dashboard](#dashboard)
- [Backtest](#backtest)
- [License](#license)

---

## 🎯 Goal
- Build a clear **ETL → ML** pipeline for financial direction classification.
- Predict **PROBA_UP** with an ensemble (LogReg + RandomForest).
- Report **Top-N bullish/bearish** and a compact probability summary.
- Produce visuals (**heatmap**) and an optional dashboard.

---

## 🖼️ Preview
<p align="center">
  <img src="images/heatmap_probs.png" alt="Probability Heatmap (Ensemble / Models)" width="70%" />
</p>

> The heatmap is generated by `scripts/plot_heatmap.py` and saved to `images/heatmap_probs.png`.

---

## ✨ Features
- 🔁 **ETL**: download, transform, deduplicate, and enrich OHLCV time series.
- 🧠 **Technical indicators**: RSI, MACD, EMA/SMA, Bollinger Bands, ATR, etc.
- 🤖 **Classification**: LogisticRegression + RandomForest + **Ensemble** (PROBA_UP).
- 📊 **Top-N** calls/puts + **CSV summary** (`models/prob_summary.csv`).
- 🖼️ **Heatmap** (PNG) for quick visual read.
- 🧪 **Logging** with automatic cleanup; light **seed** utilities.
- 🖥️ Optional **Streamlit dashboard**.

---

## 🏗️ Architecture

### Data Flow
```mermaid
flowchart LR
  A["Tickers (yfinance)"] --> B[etl/extract.py]
  B --> C[etl/transform.py]
  C --> D[etl/load.py]
  D --> R[data/raw/*.csv]

  R --> E[models/train_all.py (regression)]
  R --> F[models/train_direction.py (classification)]

  F --> S[models/prob_summary.csv]
  F --> T[models/traces/*.csv]

  S --> H[images/heatmap_probs.png]
  S --> W[apps/dashboard_app.py]
````

---

## 🧱 Star Schema

```mermaid
erDiagram
  SIGNALS ||--o{ TICKER : has
  SIGNALS ||--o{ DATE : occurs_on
  SIGNALS ||--o{ MODEL : generated_by

  SIGNALS {
    datetime datetime PK
    ticker   string   PK
    proba_logreg float
    proba_rf     float
    proba_ens    float
    pred         string  // UP/DOWN
  }

  TICKER {
    ticker      string PK
    asset_class string
  }

  DATE {
    datetime datetime PK
    year     int
    month    int
    day      int
  }

  MODEL {
    name string PK
    type string
    notes string
  }
```

---

## 📁 Repository Structure

```
ia-financiera/
├─ data/                 # raw & transformed market data
├─ models/               # training (regression/classification), traces, metrics
├─ etl/                  # extract/transform/load
├─ scripts/              # plotting utilities (heatmap)
├─ apps/                 # streamlit dashboard
├─ images/               # generated charts (heatmap_probs.png)
├─ reports/              # optional backtest outputs
├─ utils/                # config, logging, seed
├─ menu.py               # main entrypoint (ETL → Train → Predict)
├─ config.yaml           # configuration
└─ README.md             # this file
```

---

## ⚙️ Install & Run

```bash
# 1) Clone
git clone https://github.com/ShadowBlack33/ia-financiera.git
cd ia-financiera

# 2) Virtual env
python -m venv .venv
.venv\Scripts\activate   # Windows
# source .venv/bin/activate  # macOS/Linux

# 3) Dependencies
pip install -r requirements.txt

# 4) Run pipeline (ETL → Train → Predict)
python menu.py
```

Generate the heatmap (preview):

```bash
python scripts/plot_heatmap.py
# Output: images/heatmap_probs.png
```

---

## 🖥️ Dashboard

```bash
streamlit run apps/dashboard_app.py
```

Includes Top-N, probability table, and model heatmap.

---

## 📈 Backtest

```bash
python -m models.backtest
```

(Optional) Produces CSV summaries and plots under `reports/`.

---

## 📜 License

MIT © 2025 — ShadowBlack33

````